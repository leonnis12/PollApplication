{% extends "poll/base.html" %}

{% block title %}Results{% endblock %}

{% block main %}

<div class="row">
    <div class="col-lg-8 col-lg-offset-2">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Poll Result</h3>
            </div>

            <div class="panel-body">
				<h3>{{ poll.question }}</h3>
			</div>

			<ul class="list-group">
				<li id="poll-option-name-1" class="list-group-item">{{ poll.option_one }} &mdash; <strong id="poll-option-1">{{ poll.option_one_count }}</strong></li>
				<li id="poll-option-name-2"class="list-group-item">{{ poll.option_two }} &mdash; <strong id="poll-option-2" >{{ poll.option_two_count }}</strong></li>
				<li id="poll-option-name-3" class="list-group-item">{{ poll.option_three }} &mdash; <strong id="poll-option-3">{{ poll.option_three_count }}</strong></li>
			</ul>

			<div class="panel-footer">
				Total &mdash; <strong id="poll-option-total">{{ poll.total }}</strong>
			</div>
			<div style="height: 500;margin-top: 10px;">
				<canvas id="myChart" width="500" height="500"></canvas>
			</div>
			<script>
			const ctx = document.getElementById('myChart').getContext('2d');
			
			const poll1 = document.getElementById('poll-option-1').innerHTML;
			const poll2 = document.getElementById('poll-option-2').innerHTML;
			const poll3 = document.getElementById('poll-option-3').innerHTML;
			const pollName1 = document.getElementById('poll-option-name-1').innerHTML.split("—")[0];
			const pollName2 = document.getElementById('poll-option-name-2').innerHTML.split("—")[0];
			const pollName3 = document.getElementById('poll-option-name-3').innerHTML.split("—")[0];
			const poll4 = document.getElementById('poll-option-total').innerHTML;
			console.log(poll1,poll2,poll3)
			const myChart = new Chart(ctx, {
				type: 'bar',
				data: {
					labels: [pollName1,pollName2,pollName3,'Total'],
					datasets: [{
						
						data: [poll1,poll2,poll3,poll4],
						backgroundColor: [
							'rgba(255, 99, 132, 0.2)',
							'rgba(54, 162, 235, 0.2)',
							'rgba(255, 206, 86, 0.2)',
							'rgba(75, 192, 192, 0.2)',
							'rgba(153, 102, 255, 0.2)',
							'rgba(255, 159, 64, 0.2)'
						],
						borderColor: [
							'rgba(255, 99, 132, 1)',
							'rgba(54, 162, 235, 1)',
							'rgba(255, 206, 86, 1)',
							'rgba(75, 192, 192, 1)',
							'rgba(153, 102, 255, 1)',
							'rgba(255, 159, 64, 1)'
						],
						borderWidth: 1
					}]
				},
				options: {
					plugins:{   
						legend: {
							display: false
								},
							},
					barPercentage: 0.4,
					maintainAspectRatio: false,
					scales: {
						y: {
							display: true,
							suggestedMax: 10,
						},
					}
				}
			});
			</script>
        </div>	
    </div>
</div>
{% endblock %}